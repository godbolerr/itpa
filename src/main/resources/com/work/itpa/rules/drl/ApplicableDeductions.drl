package com.work.itpa.rules;

import java.util.List;
import com.work.itpa.domain.FiConstants;

import function com.work.itpa.utils.FiUtil.isAvailable;
import com.work.itpa.domain.FinPerson;
import com.work.itpa.domain.Deduction;
import com.work.itpa.domain.FinPersonResult;
import com.work.itpa.domain.Donation;


global java.util.List messages

rule "Get List of all deductions which can be availed"   
    when
        $deduction : Deduction ()
        $result : FinPersonResult( )
    then
    	$result.addDeduction($deduction);
end

// As the deduction is based on percentage of actual, there is no other variable to compare with.

rule "Find max deduction 80GGA"
   salience -50
	when
		$result : FinPersonResult( )
 		$total : Double() from accumulate(
         Deduction( sectionType == "80GGA" , $amt : amount  ),
         init( double total = 0; ),
         action( total += $amt.doubleValue(); ),
         reverse( total -= $amt.doubleValue(); ),
         result( new Double( total ) ) )		
		
	then
		$result.addFinalDeduction($total,"80GGA","");
end

rule "Find max deduction 80GGC"
   salience -50
	when
		$result : FinPersonResult( )
 		$total : Double() from accumulate(
         Deduction( $amt : amount , sectionType == "80GGC" ),
         init( double total = 0; ),
         action( total += $amt.doubleValue(); ),
         reverse( total -= $amt.doubleValue(); ),
         result( new Double( total ) ) )		
		
	then
		$result.addFinalDeduction($total,"80GGC","");
end






